Processing people:   0%|          | 0/20 [00:00<?, ?it/s][W1205 14:16:24.293627703 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45337 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4047835)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4047835)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.64it/s]
[1;36m(EngineCore_DP0 pid=4047835)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.15it/s]
[1;36m(EngineCore_DP0 pid=4047835)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.05it/s]
[1;36m(EngineCore_DP0 pid=4047835)[0;0m 
[1;36m(EngineCore_DP0 pid=4047835)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4047835)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4047835)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4047835)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4047835)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4047835)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fe5ae1971d0>' raised:
[1;36m(EngineCore_DP0 pid=4047835)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4047835)[0;0m 
[1;36m(EngineCore_DP0 pid=4047835)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4047835)[0;0m 
[rank0]:[W1205 14:16:36.758224923 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:17:09.867253068 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:40771 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048165)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048165)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4048165)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4048165)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4048165)[0;0m 
[1;36m(EngineCore_DP0 pid=4048165)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048165)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048165)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048165)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048165)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1d8014cdd0>' raised:
[1;36m(EngineCore_DP0 pid=4048165)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048165)[0;0m 
[1;36m(EngineCore_DP0 pid=4048165)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048165)[0;0m 
[rank0]:[W1205 14:17:16.162617454 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:17:46.743588719 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:50663 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048247)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048247)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4048247)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4048247)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4048247)[0;0m 
[1;36m(EngineCore_DP0 pid=4048247)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048247)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048247)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048247)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048247)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048247)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f947810c230>' raised:
[1;36m(EngineCore_DP0 pid=4048247)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048247)[0;0m 
[1;36m(EngineCore_DP0 pid=4048247)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048247)[0;0m 
[rank0]:[W1205 14:17:53.126445510 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:18:23.747571077 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:50621 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048332)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048332)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4048332)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4048332)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4048332)[0;0m 
[1;36m(EngineCore_DP0 pid=4048332)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048332)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048332)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048332)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048332)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048332)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb648258f50>' raised:
[1;36m(EngineCore_DP0 pid=4048332)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048332)[0;0m 
[1;36m(EngineCore_DP0 pid=4048332)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048332)[0;0m 
[rank0]:[W1205 14:18:31.704106410 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:19:00.875549978 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44339 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048420)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048420)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4048420)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4048420)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4048420)[0;0m 
[1;36m(EngineCore_DP0 pid=4048420)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048420)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048420)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048420)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048420)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9200aafe60>' raised:
[1;36m(EngineCore_DP0 pid=4048420)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048420)[0;0m 
[1;36m(EngineCore_DP0 pid=4048420)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048420)[0;0m 
[rank0]:[W1205 14:19:07.179043764 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:19:37.748636868 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52317 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048503)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048503)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4048503)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4048503)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4048503)[0;0m 
[1;36m(EngineCore_DP0 pid=4048503)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048503)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048503)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048503)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048503)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048503)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4c982d9370>' raised:
[1;36m(EngineCore_DP0 pid=4048503)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048503)[0;0m 
[1;36m(EngineCore_DP0 pid=4048503)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048503)[0;0m 
[rank0]:[W1205 14:19:44.853185615 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:20:13.032496600 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:50823 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048593)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048593)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4048593)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4048593)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4048593)[0;0m 
[1;36m(EngineCore_DP0 pid=4048593)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048593)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048593)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048593)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048593)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9f9c0fd790>' raised:
[1;36m(EngineCore_DP0 pid=4048593)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048593)[0;0m 
[1;36m(EngineCore_DP0 pid=4048593)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048593)[0;0m 
[rank0]:[W1205 14:20:20.251666472 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:20:51.142505036 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:53883 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048673)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048673)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4048673)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4048673)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4048673)[0;0m 
[1;36m(EngineCore_DP0 pid=4048673)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048673)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048673)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048673)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048673)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa8100e7890>' raised:
[1;36m(EngineCore_DP0 pid=4048673)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048673)[0;0m 
[1;36m(EngineCore_DP0 pid=4048673)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048673)[0;0m 
[rank0]:[W1205 14:20:58.361038324 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:21:28.592820289 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:47433 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048854)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048854)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4048854)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4048854)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4048854)[0;0m 
[1;36m(EngineCore_DP0 pid=4048854)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048854)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048854)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048854)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048854)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048854)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f5cf42e4620>' raised:
[1;36m(EngineCore_DP0 pid=4048854)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048854)[0;0m 
[1;36m(EngineCore_DP0 pid=4048854)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048854)[0;0m 
[rank0]:[W1205 14:21:35.788162853 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:22:04.112863717 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:54003 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4048941)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4048941)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4048941)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4048941)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4048941)[0;0m 
[1;36m(EngineCore_DP0 pid=4048941)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4048941)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4048941)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4048941)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4048941)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4048941)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4c1c0eb860>' raised:
[1;36m(EngineCore_DP0 pid=4048941)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4048941)[0;0m 
[1;36m(EngineCore_DP0 pid=4048941)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4048941)[0;0m 
[rank0]:[W1205 14:22:11.248448053 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:22:40.458051874 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43483 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049022)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049022)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4049022)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4049022)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4049022)[0;0m 
[1;36m(EngineCore_DP0 pid=4049022)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049022)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049022)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049022)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049022)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049022)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa6f0271880>' raised:
[1;36m(EngineCore_DP0 pid=4049022)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049022)[0;0m 
[1;36m(EngineCore_DP0 pid=4049022)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049022)[0;0m 
[rank0]:[W1205 14:22:48.671093608 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:23:17.143534410 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41187 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049106)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049106)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4049106)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4049106)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4049106)[0;0m 
[1;36m(EngineCore_DP0 pid=4049106)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049106)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049106)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049106)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049106)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049106)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1c901b84a0>' raised:
[1;36m(EngineCore_DP0 pid=4049106)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049106)[0;0m 
[1;36m(EngineCore_DP0 pid=4049106)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049106)[0;0m 
[rank0]:[W1205 14:23:24.315184293 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:23:54.581945513 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33663 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049196)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049196)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4049196)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4049196)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4049196)[0;0m 
[1;36m(EngineCore_DP0 pid=4049196)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049196)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049196)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049196)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049196)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049196)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f2820206090>' raised:
[1;36m(EngineCore_DP0 pid=4049196)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049196)[0;0m 
[1;36m(EngineCore_DP0 pid=4049196)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049196)[0;0m 
[rank0]:[W1205 14:24:01.791210135 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:24:30.307740373 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:34613 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049274)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049274)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4049274)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4049274)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4049274)[0;0m 
[1;36m(EngineCore_DP0 pid=4049274)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049274)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049274)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049274)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049274)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049274)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f02142e9100>' raised:
[1;36m(EngineCore_DP0 pid=4049274)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049274)[0;0m 
[1;36m(EngineCore_DP0 pid=4049274)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049274)[0;0m 
[rank0]:[W1205 14:24:37.445617668 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:25:07.031319501 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:60097 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049362)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049362)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4049362)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4049362)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4049362)[0;0m 
[1;36m(EngineCore_DP0 pid=4049362)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049362)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049362)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049362)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049362)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049362)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fbf9c054bf0>' raised:
[1;36m(EngineCore_DP0 pid=4049362)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049362)[0;0m 
[1;36m(EngineCore_DP0 pid=4049362)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049362)[0;0m 
[rank0]:[W1205 14:25:14.188232067 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:25:44.594119866 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:50241 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049444)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049444)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.96it/s]
[1;36m(EngineCore_DP0 pid=4049444)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.52it/s]
[1;36m(EngineCore_DP0 pid=4049444)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.42it/s]
[1;36m(EngineCore_DP0 pid=4049444)[0;0m 
[1;36m(EngineCore_DP0 pid=4049444)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049444)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049444)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049444)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049444)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049444)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f001d6974d0>' raised:
[1;36m(EngineCore_DP0 pid=4049444)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049444)[0;0m 
[1;36m(EngineCore_DP0 pid=4049444)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049444)[0;0m 
[rank0]:[W1205 14:25:51.167850947 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:26:20.354957788 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:59221 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049644)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049644)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4049644)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4049644)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4049644)[0;0m 
[1;36m(EngineCore_DP0 pid=4049644)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049644)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049644)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049644)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049644)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fdf301f1100>' raised:
[1;36m(EngineCore_DP0 pid=4049644)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049644)[0;0m 
[1;36m(EngineCore_DP0 pid=4049644)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049644)[0;0m 
[rank0]:[W1205 14:26:28.522660407 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:26:57.968424602 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:38305 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049733)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049733)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4049733)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4049733)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4049733)[0;0m 
[1;36m(EngineCore_DP0 pid=4049733)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049733)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049733)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049733)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049733)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7feec8252c00>' raised:
[1;36m(EngineCore_DP0 pid=4049733)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049733)[0;0m 
[1;36m(EngineCore_DP0 pid=4049733)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049733)[0;0m 
[rank0]:[W1205 14:27:04.128479824 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:27:33.237492791 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:46879 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049811)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049811)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4049811)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4049811)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4049811)[0;0m 
[1;36m(EngineCore_DP0 pid=4049811)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049811)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049811)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049811)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049811)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049811)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb5601f8980>' raised:
[1;36m(EngineCore_DP0 pid=4049811)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049811)[0;0m 
[1;36m(EngineCore_DP0 pid=4049811)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049811)[0;0m 
[rank0]:[W1205 14:27:40.428547017 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:28:10.804853207 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:58107 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049898)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049898)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4049898)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4049898)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4049898)[0;0m 
[1;36m(EngineCore_DP0 pid=4049898)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049898)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049898)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049898)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049898)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049898)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fc94c131100>' raised:
[1;36m(EngineCore_DP0 pid=4049898)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049898)[0;0m 
[1;36m(EngineCore_DP0 pid=4049898)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049898)[0;0m 
[rank0]:[W1205 14:28:17.904324272 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:28:46.157415638 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57403 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4049979)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4049979)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4049979)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4049979)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4049979)[0;0m 
[1;36m(EngineCore_DP0 pid=4049979)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4049979)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4049979)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4049979)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4049979)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4049979)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f669c389550>' raised:
[1;36m(EngineCore_DP0 pid=4049979)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4049979)[0;0m 
[1;36m(EngineCore_DP0 pid=4049979)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4049979)[0;0m 
[rank0]:[W1205 14:28:53.308056594 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:29:23.820542449 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44257 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050066)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050066)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050066)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050066)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4050066)[0;0m 
[1;36m(EngineCore_DP0 pid=4050066)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050066)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050066)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050066)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050066)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050066)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f56382b6cf0>' raised:
[1;36m(EngineCore_DP0 pid=4050066)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050066)[0;0m 
[1;36m(EngineCore_DP0 pid=4050066)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050066)[0;0m 
[rank0]:[W1205 14:29:30.134293094 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:29:59.352134933 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52071 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050155)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050155)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050155)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050155)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4050155)[0;0m 
[1;36m(EngineCore_DP0 pid=4050155)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050155)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050155)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050155)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050155)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9d9c283d40>' raised:
[1;36m(EngineCore_DP0 pid=4050155)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050155)[0;0m 
[1;36m(EngineCore_DP0 pid=4050155)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050155)[0;0m 
[rank0]:[W1205 14:30:07.613761089 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:30:36.080628989 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:58449 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050234)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050234)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050234)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050234)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4050234)[0;0m 
[1;36m(EngineCore_DP0 pid=4050234)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050234)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050234)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050234)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050234)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050234)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7efafd7210a0>' raised:
[1;36m(EngineCore_DP0 pid=4050234)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050234)[0;0m 
[1;36m(EngineCore_DP0 pid=4050234)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050234)[0;0m 
[rank0]:[W1205 14:30:44.560686259 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:31:14.350469266 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44735 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050343)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050343)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050343)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050343)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4050343)[0;0m 
[1;36m(EngineCore_DP0 pid=4050343)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050343)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050343)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050343)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050343)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050343)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa83c5f70b0>' raised:
[1;36m(EngineCore_DP0 pid=4050343)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050343)[0;0m 
[1;36m(EngineCore_DP0 pid=4050343)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050343)[0;0m 
[rank0]:[W1205 14:31:22.811494590 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:31:52.941883506 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56943 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050510)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050510)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050510)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050510)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4050510)[0;0m 
[1;36m(EngineCore_DP0 pid=4050510)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050510)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050510)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050510)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050510)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050510)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa5dc2d3e00>' raised:
[1;36m(EngineCore_DP0 pid=4050510)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050510)[0;0m 
[1;36m(EngineCore_DP0 pid=4050510)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050510)[0;0m 
[rank0]:[W1205 14:31:59.250156992 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:32:28.282176583 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56779 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050587)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050587)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4050587)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050587)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4050587)[0;0m 
[1;36m(EngineCore_DP0 pid=4050587)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050587)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050587)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050587)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050587)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050587)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa59828e180>' raised:
[1;36m(EngineCore_DP0 pid=4050587)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050587)[0;0m 
[1;36m(EngineCore_DP0 pid=4050587)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050587)[0;0m 
[rank0]:[W1205 14:32:35.360816331 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:33:05.533920795 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52843 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050674)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050674)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050674)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4050674)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4050674)[0;0m 
[1;36m(EngineCore_DP0 pid=4050674)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050674)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050674)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050674)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050674)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050674)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f8e802270b0>' raised:
[1;36m(EngineCore_DP0 pid=4050674)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050674)[0;0m 
[1;36m(EngineCore_DP0 pid=4050674)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050674)[0;0m 
[rank0]:[W1205 14:33:12.591621564 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:33:41.619208489 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45421 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050754)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050754)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050754)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050754)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4050754)[0;0m 
[1;36m(EngineCore_DP0 pid=4050754)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050754)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050754)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050754)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050754)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050754)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f5d7409a270>' raised:
[1;36m(EngineCore_DP0 pid=4050754)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050754)[0;0m 
[1;36m(EngineCore_DP0 pid=4050754)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050754)[0;0m 
[rank0]:[W1205 14:33:48.697187020 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:34:17.843800353 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:53539 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050840)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050840)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4050840)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4050840)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4050840)[0;0m 
[1;36m(EngineCore_DP0 pid=4050840)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050840)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050840)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050840)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050840)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050840)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fe520116f60>' raised:
[1;36m(EngineCore_DP0 pid=4050840)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050840)[0;0m 
[1;36m(EngineCore_DP0 pid=4050840)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050840)[0;0m 
[rank0]:[W1205 14:34:24.912558152 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:34:53.889265183 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56255 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4050932)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4050932)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4050932)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4050932)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4050932)[0;0m 
[1;36m(EngineCore_DP0 pid=4050932)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4050932)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4050932)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4050932)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4050932)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4050932)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fdf65336de0>' raised:
[1;36m(EngineCore_DP0 pid=4050932)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4050932)[0;0m 
[1;36m(EngineCore_DP0 pid=4050932)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4050932)[0;0m 
[rank0]:[W1205 14:35:00.015458099 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:35:29.456909633 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44661 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051009)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051009)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4051009)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4051009)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4051009)[0;0m 
[1;36m(EngineCore_DP0 pid=4051009)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051009)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051009)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051009)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051009)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051009)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f32780a6c30>' raised:
[1;36m(EngineCore_DP0 pid=4051009)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051009)[0;0m 
[1;36m(EngineCore_DP0 pid=4051009)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051009)[0;0m 
[rank0]:[W1205 14:35:37.634396097 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:36:06.861275429 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:53163 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051098)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051098)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4051098)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4051098)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4051098)[0;0m 
[1;36m(EngineCore_DP0 pid=4051098)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051098)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051098)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051098)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051098)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051098)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f28ac1e1970>' raised:
[1;36m(EngineCore_DP0 pid=4051098)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051098)[0;0m 
[1;36m(EngineCore_DP0 pid=4051098)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051098)[0;0m 
[rank0]:[W1205 14:36:13.004370077 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:36:42.390201255 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37699 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051275)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051275)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4051275)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4051275)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4051275)[0;0m 
[1;36m(EngineCore_DP0 pid=4051275)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051275)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051275)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051275)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051275)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051275)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f446007bd40>' raised:
[1;36m(EngineCore_DP0 pid=4051275)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051275)[0;0m 
[1;36m(EngineCore_DP0 pid=4051275)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051275)[0;0m 
[rank0]:[W1205 14:36:50.519381491 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:37:19.606761321 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:42913 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051361)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051361)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4051361)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4051361)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4051361)[0;0m 
[1;36m(EngineCore_DP0 pid=4051361)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051361)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051361)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051361)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051361)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051361)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f5835722ea0>' raised:
[1;36m(EngineCore_DP0 pid=4051361)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051361)[0;0m 
[1;36m(EngineCore_DP0 pid=4051361)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051361)[0;0m 
[rank0]:[W1205 14:37:26.728426818 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:37:55.989812858 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51973 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051448)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051448)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4051448)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4051448)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4051448)[0;0m 
[1;36m(EngineCore_DP0 pid=4051448)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051448)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051448)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051448)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051448)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051448)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb6a00a8d70>' raised:
[1;36m(EngineCore_DP0 pid=4051448)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051448)[0;0m 
[1;36m(EngineCore_DP0 pid=4051448)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051448)[0;0m 
[rank0]:[W1205 14:38:02.060536025 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:38:31.994988028 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:55413 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051525)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051525)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4051525)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4051525)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4051525)[0;0m 
[1;36m(EngineCore_DP0 pid=4051525)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051525)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051525)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051525)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051525)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051525)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6850275a30>' raised:
[1;36m(EngineCore_DP0 pid=4051525)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051525)[0;0m 
[1;36m(EngineCore_DP0 pid=4051525)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051525)[0;0m 
[rank0]:[W1205 14:38:38.012796991 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:39:07.213468155 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43033 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051614)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051614)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4051614)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4051614)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4051614)[0;0m 
[1;36m(EngineCore_DP0 pid=4051614)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051614)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051614)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051614)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051614)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051614)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fe3ece375c0>' raised:
[1;36m(EngineCore_DP0 pid=4051614)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051614)[0;0m 
[1;36m(EngineCore_DP0 pid=4051614)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051614)[0;0m 
[rank0]:[W1205 14:39:14.327125727 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:39:43.265440888 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45873 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051696)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051696)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4051696)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4051696)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4051696)[0;0m 
[1;36m(EngineCore_DP0 pid=4051696)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051696)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051696)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051696)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051696)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f32d02b5550>' raised:
[1;36m(EngineCore_DP0 pid=4051696)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051696)[0;0m 
[1;36m(EngineCore_DP0 pid=4051696)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051696)[0;0m 
[rank0]:[W1205 14:39:50.379512370 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:40:20.531155416 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37339 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051782)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051782)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4051782)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4051782)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4051782)[0;0m 
[1;36m(EngineCore_DP0 pid=4051782)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051782)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051782)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051782)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051782)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051782)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f7c78daaff0>' raised:
[1;36m(EngineCore_DP0 pid=4051782)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051782)[0;0m 
[1;36m(EngineCore_DP0 pid=4051782)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051782)[0;0m 
[rank0]:[W1205 14:40:27.602107487 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:40:56.577134974 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52409 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4051868)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4051868)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4051868)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4051868)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4051868)[0;0m 
[1;36m(EngineCore_DP0 pid=4051868)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4051868)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4051868)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4051868)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4051868)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4051868)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f21fc253230>' raised:
[1;36m(EngineCore_DP0 pid=4051868)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4051868)[0;0m 
[1;36m(EngineCore_DP0 pid=4051868)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4051868)[0;0m 
[rank0]:[W1205 14:41:03.928180770 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:41:32.096929419 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51369 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052040)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052040)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4052040)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4052040)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4052040)[0;0m 
[1;36m(EngineCore_DP0 pid=4052040)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052040)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052040)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052040)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052040)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052040)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff8f430a930>' raised:
[1;36m(EngineCore_DP0 pid=4052040)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052040)[0;0m 
[1;36m(EngineCore_DP0 pid=4052040)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052040)[0;0m 
[rank0]:[W1205 14:41:39.194305272 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:42:08.300661407 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:34773 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052129)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052129)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4052129)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4052129)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4052129)[0;0m 
[1;36m(EngineCore_DP0 pid=4052129)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052129)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052129)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052129)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052129)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052129)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9330043770>' raised:
[1;36m(EngineCore_DP0 pid=4052129)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052129)[0;0m 
[1;36m(EngineCore_DP0 pid=4052129)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052129)[0;0m 
[rank0]:[W1205 14:42:15.432710220 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:42:45.603598449 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37955 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052211)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052211)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4052211)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4052211)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4052211)[0;0m 
[1;36m(EngineCore_DP0 pid=4052211)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052211)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052211)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052211)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052211)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052211)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fc06c2cde20>' raised:
[1;36m(EngineCore_DP0 pid=4052211)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052211)[0;0m 
[1;36m(EngineCore_DP0 pid=4052211)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052211)[0;0m 
[rank0]:[W1205 14:42:52.685350288 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:43:21.697325412 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37385 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052296)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052296)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4052296)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4052296)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4052296)[0;0m 
[1;36m(EngineCore_DP0 pid=4052296)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052296)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052296)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052296)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052296)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052296)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f0fc816f290>' raised:
[1;36m(EngineCore_DP0 pid=4052296)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052296)[0;0m 
[1;36m(EngineCore_DP0 pid=4052296)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052296)[0;0m 
[rank0]:[W1205 14:43:28.718970470 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:43:57.884897881 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51541 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052385)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052385)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4052385)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4052385)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4052385)[0;0m 
[1;36m(EngineCore_DP0 pid=4052385)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052385)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052385)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052385)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052385)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052385)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7eff84322de0>' raised:
[1;36m(EngineCore_DP0 pid=4052385)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052385)[0;0m 
[1;36m(EngineCore_DP0 pid=4052385)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052385)[0;0m 
[rank0]:[W1205 14:44:04.938547697 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:44:33.822203960 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:50619 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052469)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052469)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4052469)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4052469)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4052469)[0;0m 
[1;36m(EngineCore_DP0 pid=4052469)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052469)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052469)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052469)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052469)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052469)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fbc0568ef00>' raised:
[1;36m(EngineCore_DP0 pid=4052469)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052469)[0;0m 
[1;36m(EngineCore_DP0 pid=4052469)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052469)[0;0m 
[rank0]:[W1205 14:44:40.816385555 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:45:10.451437070 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:47465 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052558)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052558)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4052558)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4052558)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4052558)[0;0m 
[1;36m(EngineCore_DP0 pid=4052558)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052558)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052558)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052558)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052558)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052558)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fdb041f9bb0>' raised:
[1;36m(EngineCore_DP0 pid=4052558)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052558)[0;0m 
[1;36m(EngineCore_DP0 pid=4052558)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052558)[0;0m 
[rank0]:[W1205 14:45:18.704430161 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:45:47.978347582 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:38757 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052639)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052639)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4052639)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.52it/s]
[1;36m(EngineCore_DP0 pid=4052639)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.42it/s]
[1;36m(EngineCore_DP0 pid=4052639)[0;0m 
[1;36m(EngineCore_DP0 pid=4052639)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052639)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052639)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052639)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052639)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052639)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7feedc716ff0>' raised:
[1;36m(EngineCore_DP0 pid=4052639)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052639)[0;0m 
[1;36m(EngineCore_DP0 pid=4052639)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052639)[0;0m 
[rank0]:[W1205 14:45:54.173490579 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:46:23.347638638 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51215 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052820)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052820)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4052820)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4052820)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4052820)[0;0m 
[1;36m(EngineCore_DP0 pid=4052820)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052820)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052820)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052820)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6eec3b7da0>' raised:
[1;36m(EngineCore_DP0 pid=4052820)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052820)[0;0m 
[1;36m(EngineCore_DP0 pid=4052820)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052820)[0;0m 
[rank0]:[W1205 14:46:30.406209897 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:46:59.272853106 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:35511 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4052925)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4052925)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4052925)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4052925)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4052925)[0;0m 
[1;36m(EngineCore_DP0 pid=4052925)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4052925)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4052925)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4052925)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4052925)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4052925)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f94003abfe0>' raised:
[1;36m(EngineCore_DP0 pid=4052925)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4052925)[0;0m 
[1;36m(EngineCore_DP0 pid=4052925)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4052925)[0;0m 
[rank0]:[W1205 14:47:07.512018806 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:47:37.098849312 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:60119 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053005)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053005)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4053005)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4053005)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4053005)[0;0m 
[1;36m(EngineCore_DP0 pid=4053005)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053005)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053005)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053005)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053005)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053005)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f92e037c770>' raised:
[1;36m(EngineCore_DP0 pid=4053005)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053005)[0;0m 
[1;36m(EngineCore_DP0 pid=4053005)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053005)[0;0m 
[rank0]:[W1205 14:47:44.213467742 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:48:13.090300539 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57235 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053090)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053090)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4053090)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4053090)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4053090)[0;0m 
[1;36m(EngineCore_DP0 pid=4053090)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053090)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053090)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053090)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053090)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053090)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1365663200>' raised:
[1;36m(EngineCore_DP0 pid=4053090)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053090)[0;0m 
[1;36m(EngineCore_DP0 pid=4053090)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053090)[0;0m 
[rank0]:[W1205 14:48:20.216524885 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:48:51.811213525 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37179 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053170)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053170)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4053170)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4053170)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4053170)[0;0m 
[1;36m(EngineCore_DP0 pid=4053170)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053170)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053170)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053170)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053170)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053170)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fe8030571a0>' raised:
[1;36m(EngineCore_DP0 pid=4053170)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053170)[0;0m 
[1;36m(EngineCore_DP0 pid=4053170)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053170)[0;0m 
[rank0]:[W1205 14:48:58.885536030 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:49:27.929725380 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51431 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053259)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053259)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4053259)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4053259)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4053259)[0;0m 
[1;36m(EngineCore_DP0 pid=4053259)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053259)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053259)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053259)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053259)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053259)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1711d3f290>' raised:
[1;36m(EngineCore_DP0 pid=4053259)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053259)[0;0m 
[1;36m(EngineCore_DP0 pid=4053259)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053259)[0;0m 
[rank0]:[W1205 14:49:34.003710839 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:50:03.294195553 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:60249 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053351)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053351)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4053351)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4053351)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4053351)[0;0m 
[1;36m(EngineCore_DP0 pid=4053351)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053351)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053351)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053351)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053351)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053351)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f66a01a3d40>' raised:
[1;36m(EngineCore_DP0 pid=4053351)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053351)[0;0m 
[1;36m(EngineCore_DP0 pid=4053351)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053351)[0;0m 
[rank0]:[W1205 14:50:10.373549430 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:50:39.262971675 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:58803 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053432)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053432)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4053432)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4053432)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.42it/s]
[1;36m(EngineCore_DP0 pid=4053432)[0;0m 
[1;36m(EngineCore_DP0 pid=4053432)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053432)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053432)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053432)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053432)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053432)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fd1dc325b50>' raised:
[1;36m(EngineCore_DP0 pid=4053432)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053432)[0;0m 
[1;36m(EngineCore_DP0 pid=4053432)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053432)[0;0m 
[rank0]:[W1205 14:50:46.425875028 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:51:16.599399972 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:55485 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053533)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053533)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.96it/s]
[1;36m(EngineCore_DP0 pid=4053533)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4053533)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.42it/s]
[1;36m(EngineCore_DP0 pid=4053533)[0;0m 
[1;36m(EngineCore_DP0 pid=4053533)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053533)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053533)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053533)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053533)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053533)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb02c27bb90>' raised:
[1;36m(EngineCore_DP0 pid=4053533)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053533)[0;0m 
[1;36m(EngineCore_DP0 pid=4053533)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053533)[0;0m 
[rank0]:[W1205 14:51:23.679479199 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:51:52.611705472 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44067 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053700)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053700)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4053700)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4053700)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4053700)[0;0m 
[1;36m(EngineCore_DP0 pid=4053700)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053700)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053700)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053700)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053700)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053700)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f5f8a2b2d20>' raised:
[1;36m(EngineCore_DP0 pid=4053700)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053700)[0;0m 
[1;36m(EngineCore_DP0 pid=4053700)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053700)[0;0m 
[rank0]:[W1205 14:51:59.661733289 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:52:28.158539174 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:32873 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4053776)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4053776)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4053776)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4053776)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4053776)[0;0m 
[1;36m(EngineCore_DP0 pid=4053776)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4053776)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4053776)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4053776)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4053776)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4053776)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff5d00f7410>' raised:
[1;36m(EngineCore_DP0 pid=4053776)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4053776)[0;0m 
[1;36m(EngineCore_DP0 pid=4053776)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4053776)[0;0m 
[rank0]:[W1205 14:52:35.229899053 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:53:04.123584548 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:39965 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057283)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057283)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4057283)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4057283)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4057283)[0;0m 
[1;36m(EngineCore_DP0 pid=4057283)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057283)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057283)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057283)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057283)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057283)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f0925502f60>' raised:
[1;36m(EngineCore_DP0 pid=4057283)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057283)[0;0m 
[1;36m(EngineCore_DP0 pid=4057283)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057283)[0;0m 
[rank0]:[W1205 14:53:11.148109363 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:53:40.246769631 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:39555 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057364)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057364)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4057364)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4057364)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4057364)[0;0m 
[1;36m(EngineCore_DP0 pid=4057364)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057364)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057364)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057364)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057364)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057364)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fdebc0fc230>' raised:
[1;36m(EngineCore_DP0 pid=4057364)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057364)[0;0m 
[1;36m(EngineCore_DP0 pid=4057364)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057364)[0;0m 
[rank0]:[W1205 14:53:47.226302808 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:54:16.046113877 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33583 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057449)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057449)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4057449)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4057449)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4057449)[0;0m 
[1;36m(EngineCore_DP0 pid=4057449)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057449)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057449)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057449)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057449)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057449)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fd09c1f32f0>' raised:
[1;36m(EngineCore_DP0 pid=4057449)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057449)[0;0m 
[1;36m(EngineCore_DP0 pid=4057449)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057449)[0;0m 
[rank0]:[W1205 14:54:23.171875338 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:54:52.392772735 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41481 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057538)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057538)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4057538)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4057538)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4057538)[0;0m 
[1;36m(EngineCore_DP0 pid=4057538)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057538)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057538)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057538)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057538)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057538)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb228f02b10>' raised:
[1;36m(EngineCore_DP0 pid=4057538)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057538)[0;0m 
[1;36m(EngineCore_DP0 pid=4057538)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057538)[0;0m 
[rank0]:[W1205 14:54:59.468028149 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:55:28.356146287 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57325 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057615)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057615)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4057615)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4057615)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4057615)[0;0m 
[1;36m(EngineCore_DP0 pid=4057615)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057615)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057615)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057615)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057615)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057615)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff42422d880>' raised:
[1;36m(EngineCore_DP0 pid=4057615)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057615)[0;0m 
[1;36m(EngineCore_DP0 pid=4057615)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057615)[0;0m 
[rank0]:[W1205 14:55:36.568127066 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:56:05.630568964 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56493 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057704)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057704)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4057704)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4057704)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4057704)[0;0m 
[1;36m(EngineCore_DP0 pid=4057704)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057704)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057704)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057704)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057704)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f3e7d1067e0>' raised:
[1;36m(EngineCore_DP0 pid=4057704)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057704)[0;0m 
[1;36m(EngineCore_DP0 pid=4057704)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057704)[0;0m 
[rank0]:[W1205 14:56:12.275326876 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:56:41.132279221 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:58989 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057881)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057881)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4057881)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4057881)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4057881)[0;0m 
[1;36m(EngineCore_DP0 pid=4057881)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057881)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057881)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057881)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057881)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057881)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f42cc2656d0>' raised:
[1;36m(EngineCore_DP0 pid=4057881)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057881)[0;0m 
[1;36m(EngineCore_DP0 pid=4057881)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057881)[0;0m 
[rank0]:[W1205 14:56:48.217834816 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:57:17.259543928 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45915 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4057965)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4057965)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4057965)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4057965)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4057965)[0;0m 
[1;36m(EngineCore_DP0 pid=4057965)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4057965)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4057965)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4057965)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4057965)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4057965)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f3f38289f40>' raised:
[1;36m(EngineCore_DP0 pid=4057965)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4057965)[0;0m 
[1;36m(EngineCore_DP0 pid=4057965)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4057965)[0;0m 
[rank0]:[W1205 14:57:24.343704793 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:57:53.102542668 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:48187 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058055)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058055)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4058055)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4058055)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4058055)[0;0m 
[1;36m(EngineCore_DP0 pid=4058055)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058055)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058055)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058055)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058055)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058055)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fd378128050>' raised:
[1;36m(EngineCore_DP0 pid=4058055)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058055)[0;0m 
[1;36m(EngineCore_DP0 pid=4058055)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058055)[0;0m 
[rank0]:[W1205 14:58:00.179095653 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:58:29.224982015 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:38957 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058131)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058131)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4058131)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4058131)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4058131)[0;0m 
[1;36m(EngineCore_DP0 pid=4058131)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058131)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058131)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058131)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058131)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058131)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1ae82eb3e0>' raised:
[1;36m(EngineCore_DP0 pid=4058131)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058131)[0;0m 
[1;36m(EngineCore_DP0 pid=4058131)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058131)[0;0m 
[rank0]:[W1205 14:58:36.316064102 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:59:05.134031628 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:35535 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058219)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058219)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4058219)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4058219)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4058219)[0;0m 
[1;36m(EngineCore_DP0 pid=4058219)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058219)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058219)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058219)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058219)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058219)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fd9a0011a90>' raised:
[1;36m(EngineCore_DP0 pid=4058219)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058219)[0;0m 
[1;36m(EngineCore_DP0 pid=4058219)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058219)[0;0m 
[rank0]:[W1205 14:59:12.158215642 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 14:59:41.295034965 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:40627 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058301)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058301)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4058301)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4058301)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4058301)[0;0m 
[1;36m(EngineCore_DP0 pid=4058301)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058301)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058301)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058301)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058301)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058301)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f312633f050>' raised:
[1;36m(EngineCore_DP0 pid=4058301)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058301)[0;0m 
[1;36m(EngineCore_DP0 pid=4058301)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058301)[0;0m 
[rank0]:[W1205 14:59:48.348076906 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:00:17.320536832 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:38551 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058386)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058386)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4058386)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4058386)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4058386)[0;0m 
[1;36m(EngineCore_DP0 pid=4058386)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058386)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058386)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058386)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058386)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058386)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9a442a3710>' raised:
[1;36m(EngineCore_DP0 pid=4058386)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058386)[0;0m 
[1;36m(EngineCore_DP0 pid=4058386)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058386)[0;0m 
[rank0]:[W1205 15:00:25.554440861 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:00:55.534338992 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37991 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058474)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058474)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4058474)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4058474)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4058474)[0;0m 
[1;36m(EngineCore_DP0 pid=4058474)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058474)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058474)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058474)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058474)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f85508fee70>' raised:
[1;36m(EngineCore_DP0 pid=4058474)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058474)[0;0m 
[1;36m(EngineCore_DP0 pid=4058474)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058474)[0;0m 
[rank0]:[W1205 15:01:02.711856883 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:01:32.499926769 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:34369 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058658)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058658)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4058658)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4058658)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4058658)[0;0m 
[1;36m(EngineCore_DP0 pid=4058658)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058658)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058658)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058658)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058658)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058658)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fd960343080>' raised:
[1;36m(EngineCore_DP0 pid=4058658)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058658)[0;0m 
[1;36m(EngineCore_DP0 pid=4058658)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058658)[0;0m 
[rank0]:[W1205 15:01:39.512828219 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:02:08.532273238 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51865 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058746)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058746)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4058746)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4058746)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4058746)[0;0m 
[1;36m(EngineCore_DP0 pid=4058746)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058746)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058746)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058746)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058746)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058746)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff61c25d640>' raised:
[1;36m(EngineCore_DP0 pid=4058746)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058746)[0;0m 
[1;36m(EngineCore_DP0 pid=4058746)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058746)[0;0m 
[rank0]:[W1205 15:02:15.606436785 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:02:43.420888194 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51521 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058827)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058827)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4058827)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4058827)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4058827)[0;0m 
[1;36m(EngineCore_DP0 pid=4058827)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058827)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058827)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058827)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058827)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058827)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7efd0cfcbd40>' raised:
[1;36m(EngineCore_DP0 pid=4058827)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058827)[0;0m 
[1;36m(EngineCore_DP0 pid=4058827)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058827)[0;0m 
[rank0]:[W1205 15:02:51.534950953 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:03:21.178413150 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41337 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4058913)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4058913)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4058913)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4058913)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4058913)[0;0m 
[1;36m(EngineCore_DP0 pid=4058913)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4058913)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4058913)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4058913)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4058913)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4058913)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f06001ebe90>' raised:
[1;36m(EngineCore_DP0 pid=4058913)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4058913)[0;0m 
[1;36m(EngineCore_DP0 pid=4058913)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4058913)[0;0m 
[rank0]:[W1205 15:03:28.239965868 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:03:57.151020852 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36517 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059000)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059000)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059000)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059000)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4059000)[0;0m 
[1;36m(EngineCore_DP0 pid=4059000)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059000)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059000)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059000)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059000)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059000)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f2c183df860>' raised:
[1;36m(EngineCore_DP0 pid=4059000)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059000)[0;0m 
[1;36m(EngineCore_DP0 pid=4059000)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059000)[0;0m 
[rank0]:[W1205 15:04:04.199260113 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:04:33.308430154 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41405 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059079)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059079)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059079)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059079)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4059079)[0;0m 
[1;36m(EngineCore_DP0 pid=4059079)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059079)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059079)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059079)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059079)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059079)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1f7c1e3f50>' raised:
[1;36m(EngineCore_DP0 pid=4059079)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059079)[0;0m 
[1;36m(EngineCore_DP0 pid=4059079)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059079)[0;0m 
[rank0]:[W1205 15:04:40.331824392 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:05:09.252160248 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:54233 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059171)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059171)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4059171)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059171)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4059171)[0;0m 
[1;36m(EngineCore_DP0 pid=4059171)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059171)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059171)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059171)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059171)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059171)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff0d819d7f0>' raised:
[1;36m(EngineCore_DP0 pid=4059171)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059171)[0;0m 
[1;36m(EngineCore_DP0 pid=4059171)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059171)[0;0m 
[rank0]:[W1205 15:05:16.284640003 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:05:45.415432902 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52189 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059271)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059271)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059271)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059271)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4059271)[0;0m 
[1;36m(EngineCore_DP0 pid=4059271)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059271)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059271)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059271)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059271)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059271)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb6e8193d40>' raised:
[1;36m(EngineCore_DP0 pid=4059271)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059271)[0;0m 
[1;36m(EngineCore_DP0 pid=4059271)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059271)[0;0m 
[rank0]:[W1205 15:05:52.432467934 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:06:21.418679785 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:47249 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059452)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059452)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4059452)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4059452)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4059452)[0;0m 
[1;36m(EngineCore_DP0 pid=4059452)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059452)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059452)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059452)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059452)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059452)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9128354530>' raised:
[1;36m(EngineCore_DP0 pid=4059452)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059452)[0;0m 
[1;36m(EngineCore_DP0 pid=4059452)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059452)[0;0m 
[rank0]:[W1205 15:06:29.621454168 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:06:58.840547926 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37217 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059549)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059549)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059549)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059549)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4059549)[0;0m 
[1;36m(EngineCore_DP0 pid=4059549)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059549)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059549)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059549)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059549)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fdad420bcb0>' raised:
[1;36m(EngineCore_DP0 pid=4059549)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059549)[0;0m 
[1;36m(EngineCore_DP0 pid=4059549)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059549)[0;0m 
[rank0]:[W1205 15:07:05.899473859 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:07:35.356074085 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51517 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059626)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059626)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059626)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059626)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4059626)[0;0m 
[1;36m(EngineCore_DP0 pid=4059626)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059626)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059626)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059626)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059626)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059626)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7feb20268200>' raised:
[1;36m(EngineCore_DP0 pid=4059626)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059626)[0;0m 
[1;36m(EngineCore_DP0 pid=4059626)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059626)[0;0m 
[rank0]:[W1205 15:07:42.432260110 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:08:12.491212453 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36875 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059714)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059714)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059714)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059714)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4059714)[0;0m 
[1;36m(EngineCore_DP0 pid=4059714)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059714)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059714)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059714)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059714)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059714)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6c742b9460>' raised:
[1;36m(EngineCore_DP0 pid=4059714)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059714)[0;0m 
[1;36m(EngineCore_DP0 pid=4059714)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059714)[0;0m 
[rank0]:[W1205 15:08:18.467134572 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:08:47.324374105 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:59153 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059794)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059794)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4059794)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4059794)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4059794)[0;0m 
[1;36m(EngineCore_DP0 pid=4059794)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059794)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059794)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059794)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059794)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059794)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f23602f3d40>' raised:
[1;36m(EngineCore_DP0 pid=4059794)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059794)[0;0m 
[1;36m(EngineCore_DP0 pid=4059794)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059794)[0;0m 
[rank0]:[W1205 15:08:54.321349131 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:09:23.289960482 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:35459 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059880)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059880)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059880)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059880)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4059880)[0;0m 
[1;36m(EngineCore_DP0 pid=4059880)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059880)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059880)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059880)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059880)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059880)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f236cd0a2d0>' raised:
[1;36m(EngineCore_DP0 pid=4059880)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059880)[0;0m 
[1;36m(EngineCore_DP0 pid=4059880)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059880)[0;0m 
[rank0]:[W1205 15:09:30.215415704 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:09:59.098920637 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:38197 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4059970)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4059970)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4059970)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4059970)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4059970)[0;0m 
[1;36m(EngineCore_DP0 pid=4059970)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4059970)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4059970)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4059970)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4059970)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4059970)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4d301250d0>' raised:
[1;36m(EngineCore_DP0 pid=4059970)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4059970)[0;0m 
[1;36m(EngineCore_DP0 pid=4059970)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4059970)[0;0m 
[rank0]:[W1205 15:10:06.043833043 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:10:35.152610841 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37339 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060050)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060050)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4060050)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4060050)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4060050)[0;0m 
[1;36m(EngineCore_DP0 pid=4060050)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060050)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060050)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060050)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060050)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060050)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f46082dbb00>' raised:
[1;36m(EngineCore_DP0 pid=4060050)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060050)[0;0m 
[1;36m(EngineCore_DP0 pid=4060050)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060050)[0;0m 
[rank0]:[W1205 15:10:42.142319340 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:11:11.952418156 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:48387 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060155)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060155)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4060155)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4060155)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4060155)[0;0m 
[1;36m(EngineCore_DP0 pid=4060155)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060155)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060155)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060155)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060155)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060155)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f88bc191c10>' raised:
[1;36m(EngineCore_DP0 pid=4060155)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060155)[0;0m 
[1;36m(EngineCore_DP0 pid=4060155)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060155)[0;0m 
[rank0]:[W1205 15:11:18.005735630 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:11:48.058175721 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:35113 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060313)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060313)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4060313)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4060313)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4060313)[0;0m 
[1;36m(EngineCore_DP0 pid=4060313)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060313)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060313)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060313)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060313)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060313)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fce20110500>' raised:
[1;36m(EngineCore_DP0 pid=4060313)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060313)[0;0m 
[1;36m(EngineCore_DP0 pid=4060313)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060313)[0;0m 
[rank0]:[W1205 15:11:55.205892796 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:12:26.848306370 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:58693 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060399)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060399)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4060399)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4060399)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4060399)[0;0m 
[1;36m(EngineCore_DP0 pid=4060399)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060399)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060399)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060399)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060399)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060399)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fe644216cf0>' raised:
[1;36m(EngineCore_DP0 pid=4060399)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060399)[0;0m 
[1;36m(EngineCore_DP0 pid=4060399)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060399)[0;0m 
[rank0]:[W1205 15:12:33.830245746 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:13:02.074267539 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36707 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060487)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060487)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4060487)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4060487)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4060487)[0;0m 
[1;36m(EngineCore_DP0 pid=4060487)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060487)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060487)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060487)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060487)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060487)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f368c285b20>' raised:
[1;36m(EngineCore_DP0 pid=4060487)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060487)[0;0m 
[1;36m(EngineCore_DP0 pid=4060487)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060487)[0;0m 
[rank0]:[W1205 15:13:09.044827185 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:13:38.150715475 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:35319 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060566)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060566)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4060566)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4060566)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4060566)[0;0m 
[1;36m(EngineCore_DP0 pid=4060566)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060566)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060566)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060566)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060566)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060566)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f63e0139100>' raised:
[1;36m(EngineCore_DP0 pid=4060566)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060566)[0;0m 
[1;36m(EngineCore_DP0 pid=4060566)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060566)[0;0m 
[rank0]:[W1205 15:13:45.262259138 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:14:14.381418497 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57271 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060652)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060652)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4060652)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4060652)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4060652)[0;0m 
[1;36m(EngineCore_DP0 pid=4060652)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060652)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060652)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060652)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060652)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060652)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f7fb021d2e0>' raised:
[1;36m(EngineCore_DP0 pid=4060652)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060652)[0;0m 
[1;36m(EngineCore_DP0 pid=4060652)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060652)[0;0m 
[rank0]:[W1205 15:14:21.461204880 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:14:51.544542231 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:47207 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060734)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060734)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4060734)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4060734)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4060734)[0;0m 
[1;36m(EngineCore_DP0 pid=4060734)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060734)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060734)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060734)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060734)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060734)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f2cac1fefc0>' raised:
[1;36m(EngineCore_DP0 pid=4060734)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060734)[0;0m 
[1;36m(EngineCore_DP0 pid=4060734)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060734)[0;0m 
[rank0]:[W1205 15:14:58.584433784 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:15:27.914740990 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:58147 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060820)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060820)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4060820)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4060820)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4060820)[0;0m 
[1;36m(EngineCore_DP0 pid=4060820)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060820)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060820)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060820)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f872b6bb110>' raised:
[1;36m(EngineCore_DP0 pid=4060820)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060820)[0;0m 
[1;36m(EngineCore_DP0 pid=4060820)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060820)[0;0m 
[rank0]:[W1205 15:15:34.903924507 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:16:03.790639248 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:34439 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4060908)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4060908)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4060908)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4060908)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4060908)[0;0m 
[1;36m(EngineCore_DP0 pid=4060908)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4060908)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4060908)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4060908)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4060908)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4060908)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6a91deeb40>' raised:
[1;36m(EngineCore_DP0 pid=4060908)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4060908)[0;0m 
[1;36m(EngineCore_DP0 pid=4060908)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4060908)[0;0m 
[rank0]:[W1205 15:16:10.805563325 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:16:40.826084323 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:48003 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061085)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061085)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4061085)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4061085)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4061085)[0;0m 
[1;36m(EngineCore_DP0 pid=4061085)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061085)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061085)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061085)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061085)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061085)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f71c4118170>' raised:
[1;36m(EngineCore_DP0 pid=4061085)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061085)[0;0m 
[1;36m(EngineCore_DP0 pid=4061085)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061085)[0;0m 
[rank0]:[W1205 15:16:47.868173135 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:17:16.888215437 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44701 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061169)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061169)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4061169)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4061169)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4061169)[0;0m 
[1;36m(EngineCore_DP0 pid=4061169)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061169)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061169)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061169)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061169)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061169)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f52e82e5df0>' raised:
[1;36m(EngineCore_DP0 pid=4061169)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061169)[0;0m 
[1;36m(EngineCore_DP0 pid=4061169)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061169)[0;0m 
[rank0]:[W1205 15:17:23.889884051 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:17:52.066182620 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:42809 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061258)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061258)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4061258)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4061258)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4061258)[0;0m 
[1;36m(EngineCore_DP0 pid=4061258)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061258)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061258)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061258)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061258)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061258)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4aa13346e0>' raised:
[1;36m(EngineCore_DP0 pid=4061258)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061258)[0;0m 
[1;36m(EngineCore_DP0 pid=4061258)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061258)[0;0m 
[rank0]:[W1205 15:17:59.083508536 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:18:28.124228151 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:40383 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061334)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061334)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4061334)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4061334)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4061334)[0;0m 
[1;36m(EngineCore_DP0 pid=4061334)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061334)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061334)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061334)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061334)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061334)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6a2c15bbf0>' raised:
[1;36m(EngineCore_DP0 pid=4061334)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061334)[0;0m 
[1;36m(EngineCore_DP0 pid=4061334)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061334)[0;0m 
[rank0]:[W1205 15:18:35.163132937 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:19:04.210273195 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52463 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061423)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061423)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4061423)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4061423)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4061423)[0;0m 
[1;36m(EngineCore_DP0 pid=4061423)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061423)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061423)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061423)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061423)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061423)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7facfc257c20>' raised:
[1;36m(EngineCore_DP0 pid=4061423)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061423)[0;0m 
[1;36m(EngineCore_DP0 pid=4061423)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061423)[0;0m 
[rank0]:[W1205 15:19:11.230968567 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:19:40.166602469 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:34543 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061507)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061507)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4061507)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4061507)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.46it/s]
[1;36m(EngineCore_DP0 pid=4061507)[0;0m 
[1;36m(EngineCore_DP0 pid=4061507)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061507)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061507)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061507)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061507)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb23c075970>' raised:
[1;36m(EngineCore_DP0 pid=4061507)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061507)[0;0m 
[1;36m(EngineCore_DP0 pid=4061507)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061507)[0;0m 
[rank0]:[W1205 15:19:47.175007995 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:20:16.340093813 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37777 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061594)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061594)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4061594)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4061594)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4061594)[0;0m 
[1;36m(EngineCore_DP0 pid=4061594)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061594)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061594)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061594)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061594)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061594)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f806c154c80>' raised:
[1;36m(EngineCore_DP0 pid=4061594)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061594)[0;0m 
[1;36m(EngineCore_DP0 pid=4061594)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061594)[0;0m 
[rank0]:[W1205 15:20:23.437596034 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:20:52.366696968 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:34893 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061683)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061683)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4061683)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4061683)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4061683)[0;0m 
[1;36m(EngineCore_DP0 pid=4061683)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061683)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061683)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061683)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061683)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061683)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa604108d70>' raised:
[1;36m(EngineCore_DP0 pid=4061683)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061683)[0;0m 
[1;36m(EngineCore_DP0 pid=4061683)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061683)[0;0m 
[rank0]:[W1205 15:20:59.379466734 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:21:28.423315131 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41827 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061855)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061855)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4061855)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4061855)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4061855)[0;0m 
[1;36m(EngineCore_DP0 pid=4061855)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061855)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061855)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061855)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061855)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061855)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f45fc1e7020>' raised:
[1;36m(EngineCore_DP0 pid=4061855)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061855)[0;0m 
[1;36m(EngineCore_DP0 pid=4061855)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061855)[0;0m 
[rank0]:[W1205 15:21:36.612999135 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:22:04.407792123 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:42393 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4061943)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4061943)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4061943)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4061943)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4061943)[0;0m 
[1;36m(EngineCore_DP0 pid=4061943)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4061943)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4061943)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4061943)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4061943)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4061943)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f0c7033c8c0>' raised:
[1;36m(EngineCore_DP0 pid=4061943)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4061943)[0;0m 
[1;36m(EngineCore_DP0 pid=4061943)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4061943)[0;0m 
[rank0]:[W1205 15:22:11.369656752 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:22:42.049473379 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41767 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062024)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062024)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4062024)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4062024)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4062024)[0;0m 
[1;36m(EngineCore_DP0 pid=4062024)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062024)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062024)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062024)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062024)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062024)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fcf8c292360>' raised:
[1;36m(EngineCore_DP0 pid=4062024)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062024)[0;0m 
[1;36m(EngineCore_DP0 pid=4062024)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062024)[0;0m 
[rank0]:[W1205 15:22:49.048055186 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:23:18.005497339 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43333 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062108)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062108)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4062108)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4062108)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4062108)[0;0m 
[1;36m(EngineCore_DP0 pid=4062108)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062108)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062108)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062108)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062108)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062108)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f20201204a0>' raised:
[1;36m(EngineCore_DP0 pid=4062108)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062108)[0;0m 
[1;36m(EngineCore_DP0 pid=4062108)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062108)[0;0m 
[rank0]:[W1205 15:23:25.076749436 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:23:54.242502968 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56517 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062197)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062197)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4062197)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4062197)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4062197)[0;0m 
[1;36m(EngineCore_DP0 pid=4062197)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062197)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062197)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062197)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062197)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062197)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f85d035b0e0>' raised:
[1;36m(EngineCore_DP0 pid=4062197)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062197)[0;0m 
[1;36m(EngineCore_DP0 pid=4062197)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062197)[0;0m 
[rank0]:[W1205 15:24:01.201023158 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:24:30.033662369 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52083 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062276)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062276)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4062276)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4062276)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4062276)[0;0m 
[1;36m(EngineCore_DP0 pid=4062276)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062276)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062276)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062276)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062276)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062276)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f95c43d38f0>' raised:
[1;36m(EngineCore_DP0 pid=4062276)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062276)[0;0m 
[1;36m(EngineCore_DP0 pid=4062276)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062276)[0;0m 
[rank0]:[W1205 15:24:37.067566168 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:25:06.173128756 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45941 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062365)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062365)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4062365)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4062365)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4062365)[0;0m 
[1;36m(EngineCore_DP0 pid=4062365)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062365)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062365)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062365)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062365)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062365)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fef600f9460>' raised:
[1;36m(EngineCore_DP0 pid=4062365)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062365)[0;0m 
[1;36m(EngineCore_DP0 pid=4062365)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062365)[0;0m 
[rank0]:[W1205 15:25:13.144287443 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:25:42.061486230 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36115 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062446)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062446)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4062446)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4062446)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4062446)[0;0m 
[1;36m(EngineCore_DP0 pid=4062446)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062446)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062446)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062446)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062446)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062446)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6c197cb0b0>' raised:
[1;36m(EngineCore_DP0 pid=4062446)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062446)[0;0m 
[1;36m(EngineCore_DP0 pid=4062446)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062446)[0;0m 
[rank0]:[W1205 15:25:49.058484266 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:26:18.214109485 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:38345 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062630)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062630)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4062630)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4062630)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4062630)[0;0m 
[1;36m(EngineCore_DP0 pid=4062630)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062630)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062630)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062630)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062630)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062630)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f8f102bd010>' raised:
[1;36m(EngineCore_DP0 pid=4062630)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062630)[0;0m 
[1;36m(EngineCore_DP0 pid=4062630)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062630)[0;0m 
[rank0]:[W1205 15:26:25.150575656 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:26:54.969245580 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:48559 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062718)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062718)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4062718)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4062718)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4062718)[0;0m 
[1;36m(EngineCore_DP0 pid=4062718)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062718)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062718)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062718)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062718)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062718)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9a28088aa0>' raised:
[1;36m(EngineCore_DP0 pid=4062718)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062718)[0;0m 
[1;36m(EngineCore_DP0 pid=4062718)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062718)[0;0m 
[rank0]:[W1205 15:27:01.918319478 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:27:30.986094715 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:53947 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062796)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062796)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.95it/s]
[1;36m(EngineCore_DP0 pid=4062796)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.51it/s]
[1;36m(EngineCore_DP0 pid=4062796)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.41it/s]
[1;36m(EngineCore_DP0 pid=4062796)[0;0m 
[1;36m(EngineCore_DP0 pid=4062796)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062796)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062796)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062796)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062796)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062796)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f2a94221f10>' raised:
[1;36m(EngineCore_DP0 pid=4062796)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062796)[0;0m 
[1;36m(EngineCore_DP0 pid=4062796)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062796)[0;0m 
[rank0]:[W1205 15:27:37.056164270 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:28:06.806989895 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36723 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062883)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062883)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4062883)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4062883)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4062883)[0;0m 
[1;36m(EngineCore_DP0 pid=4062883)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062883)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062883)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062883)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062883)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062883)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f38001284a0>' raised:
[1;36m(EngineCore_DP0 pid=4062883)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062883)[0;0m 
[1;36m(EngineCore_DP0 pid=4062883)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062883)[0;0m 
[rank0]:[W1205 15:28:13.800452352 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:28:42.771150113 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33047 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4062963)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4062963)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4062963)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4062963)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4062963)[0;0m 
[1;36m(EngineCore_DP0 pid=4062963)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4062963)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4062963)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4062963)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4062963)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4062963)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1da0257b90>' raised:
[1;36m(EngineCore_DP0 pid=4062963)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4062963)[0;0m 
[1;36m(EngineCore_DP0 pid=4062963)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4062963)[0;0m 
[rank0]:[W1205 15:28:49.715812599 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:29:18.250733220 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:55437 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4063049)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4063049)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4063049)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4063049)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4063049)[0;0m 
[1;36m(EngineCore_DP0 pid=4063049)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4063049)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4063049)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063049)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4063049)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4063049)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f13541b5ee0>' raised:
[1;36m(EngineCore_DP0 pid=4063049)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4063049)[0;0m 
[1;36m(EngineCore_DP0 pid=4063049)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4063049)[0;0m 
[rank0]:[W1205 15:29:25.252477340 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:29:54.297734260 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56687 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4063138)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4063138)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4063138)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4063138)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4063138)[0;0m 
[1;36m(EngineCore_DP0 pid=4063138)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4063138)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4063138)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063138)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4063138)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4063138)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f8e9c123d10>' raised:
[1;36m(EngineCore_DP0 pid=4063138)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4063138)[0;0m 
[1;36m(EngineCore_DP0 pid=4063138)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4063138)[0;0m 
[rank0]:[W1205 15:30:01.263586396 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:30:30.081613805 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36819 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4063216)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4063216)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4063216)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4063216)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4063216)[0;0m 
[1;36m(EngineCore_DP0 pid=4063216)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4063216)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4063216)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063216)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4063216)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4063216)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f89b8380140>' raised:
[1;36m(EngineCore_DP0 pid=4063216)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4063216)[0;0m 
[1;36m(EngineCore_DP0 pid=4063216)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4063216)[0;0m 
[rank0]:[W1205 15:30:37.092712696 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:31:07.994388727 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57715 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4063303)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4063303)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4063303)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4063303)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4063303)[0;0m 
[1;36m(EngineCore_DP0 pid=4063303)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4063303)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4063303)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063303)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4063303)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4063303)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f14da1b2f90>' raised:
[1;36m(EngineCore_DP0 pid=4063303)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4063303)[0;0m 
[1;36m(EngineCore_DP0 pid=4063303)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4063303)[0;0m 
[rank0]:[W1205 15:31:14.010481244 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:31:45.118148052 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:54337 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4063480)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4063480)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4063480)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4063480)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4063480)[0;0m 
[1;36m(EngineCore_DP0 pid=4063480)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4063480)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4063480)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063480)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4063480)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4063480)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9220108e30>' raised:
[1;36m(EngineCore_DP0 pid=4063480)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4063480)[0;0m 
[1;36m(EngineCore_DP0 pid=4063480)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4063480)[0;0m 
[rank0]:[W1205 15:31:52.103824649 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 15:32:22.582458713 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41651 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4063565)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4063565)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4063565)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4063565)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4063565)[0;0m 
[1;36m(EngineCore_DP0 pid=4063565)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4063565)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4063565)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4063565)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4063565)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4063565)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f70282c97c0>' raised:
[1;36m(EngineCore_DP0 pid=4063565)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4063565)[0;0m 
[1;36m(EngineCore_DP0 pid=4063565)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4063565)[0;0m 
[rank0]:[W1205 15:32:29.904723818 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/ch269957/projects/slm_multiagent_debate/tasks/biography/gen_conversation.py", line 8, in <module>
    from utils import (
  File "/home/ch269957/projects/slm_multiagent_debate/utils/__init__.py", line 10, in <module>
    from .llm_wrapper import ChatCompletion
  File "/home/ch269957/projects/slm_multiagent_debate/utils/llm_wrapper.py", line 24, in <module>
    from .model_cache import ModelCache
  File "/home/ch269957/projects/slm_multiagent_debate/utils/model_cache.py", line 119
    max_model_len=max_model_len # =max_model_len
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: invalid syntax. Perhaps you forgot a comma?
[W1205 16:07:20.271586987 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44963 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4065440)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4065440)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4065440)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4065440)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4065440)[0;0m 
[1;36m(EngineCore_DP0 pid=4065440)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4065440)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4065440)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065440)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4065440)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4065440)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa170166720>' raised:
[1;36m(EngineCore_DP0 pid=4065440)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4065440)[0;0m 
[1;36m(EngineCore_DP0 pid=4065440)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4065440)[0;0m 
[rank0]:[W1205 16:07:28.023269411 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:07:57.117809936 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33575 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4065529)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4065529)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4065529)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4065529)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.46it/s]
[1;36m(EngineCore_DP0 pid=4065529)[0;0m 
[1;36m(EngineCore_DP0 pid=4065529)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4065529)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4065529)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065529)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4065529)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4065529)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f98d01b92b0>' raised:
[1;36m(EngineCore_DP0 pid=4065529)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4065529)[0;0m 
[1;36m(EngineCore_DP0 pid=4065529)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4065529)[0;0m 
[rank0]:[W1205 16:08:04.141148898 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:08:34.963392786 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36497 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4065605)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4065605)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4065605)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4065605)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4065605)[0;0m 
[1;36m(EngineCore_DP0 pid=4065605)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4065605)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4065605)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065605)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4065605)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4065605)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1804327ef0>' raised:
[1;36m(EngineCore_DP0 pid=4065605)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4065605)[0;0m 
[1;36m(EngineCore_DP0 pid=4065605)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4065605)[0;0m 
[rank0]:[W1205 16:08:41.012393576 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:09:10.762716405 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:38917 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4065696)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4065696)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4065696)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4065696)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4065696)[0;0m 
[1;36m(EngineCore_DP0 pid=4065696)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4065696)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4065696)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065696)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4065696)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4065696)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4828228c20>' raised:
[1;36m(EngineCore_DP0 pid=4065696)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4065696)[0;0m 
[1;36m(EngineCore_DP0 pid=4065696)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4065696)[0;0m 
[rank0]:[W1205 16:09:17.771413672 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:09:47.638218409 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51131 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4065778)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4065778)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4065778)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4065778)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4065778)[0;0m 
[1;36m(EngineCore_DP0 pid=4065778)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4065778)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4065778)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065778)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4065778)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4065778)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb3a839ff20>' raised:
[1;36m(EngineCore_DP0 pid=4065778)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4065778)[0;0m 
[1;36m(EngineCore_DP0 pid=4065778)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4065778)[0;0m 
[rank0]:[W1205 16:09:54.747728154 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:10:23.700955471 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:44887 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4065866)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4065866)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4065866)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4065866)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4065866)[0;0m 
[1;36m(EngineCore_DP0 pid=4065866)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4065866)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4065866)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065866)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4065866)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4065866)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4f540da480>' raised:
[1;36m(EngineCore_DP0 pid=4065866)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4065866)[0;0m 
[1;36m(EngineCore_DP0 pid=4065866)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4065866)[0;0m 
[rank0]:[W1205 16:10:30.649226495 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:10:59.424415932 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36611 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4065954)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4065954)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4065954)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4065954)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4065954)[0;0m 
[1;36m(EngineCore_DP0 pid=4065954)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4065954)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4065954)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4065954)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4065954)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4065954)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f65c8044530>' raised:
[1;36m(EngineCore_DP0 pid=4065954)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4065954)[0;0m 
[1;36m(EngineCore_DP0 pid=4065954)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4065954)[0;0m 
[rank0]:[W1205 16:11:07.498425103 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:11:35.421259118 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33171 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066128)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066128)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4066128)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4066128)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4066128)[0;0m 
[1;36m(EngineCore_DP0 pid=4066128)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066128)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066128)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066128)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066128)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066128)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6198072de0>' raised:
[1;36m(EngineCore_DP0 pid=4066128)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066128)[0;0m 
[1;36m(EngineCore_DP0 pid=4066128)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066128)[0;0m 
[rank0]:[W1205 16:11:43.484692867 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:12:13.542821855 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37753 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066214)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066214)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4066214)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4066214)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4066214)[0;0m 
[1;36m(EngineCore_DP0 pid=4066214)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066214)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066214)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066214)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066214)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066214)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f05d976ed20>' raised:
[1;36m(EngineCore_DP0 pid=4066214)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066214)[0;0m 
[1;36m(EngineCore_DP0 pid=4066214)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066214)[0;0m 
[rank0]:[W1205 16:12:20.638245078 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:12:49.947481397 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33395 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066295)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066295)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4066295)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4066295)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4066295)[0;0m 
[1;36m(EngineCore_DP0 pid=4066295)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066295)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066295)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066295)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066295)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066295)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f1141d34920>' raised:
[1;36m(EngineCore_DP0 pid=4066295)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066295)[0;0m 
[1;36m(EngineCore_DP0 pid=4066295)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066295)[0;0m 
[rank0]:[W1205 16:12:57.914106633 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:13:27.614684960 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:53183 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066380)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066380)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4066380)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4066380)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4066380)[0;0m 
[1;36m(EngineCore_DP0 pid=4066380)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066380)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066380)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066380)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066380)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066380)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f87e0164c80>' raised:
[1;36m(EngineCore_DP0 pid=4066380)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066380)[0;0m 
[1;36m(EngineCore_DP0 pid=4066380)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066380)[0;0m 
[rank0]:[W1205 16:13:34.682174901 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:14:02.347903980 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57285 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066468)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066468)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4066468)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4066468)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4066468)[0;0m 
[1;36m(EngineCore_DP0 pid=4066468)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066468)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066468)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066468)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066468)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066468)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fd23c3404a0>' raised:
[1;36m(EngineCore_DP0 pid=4066468)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066468)[0;0m 
[1;36m(EngineCore_DP0 pid=4066468)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066468)[0;0m 
[rank0]:[W1205 16:14:09.362649622 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:14:40.799542326 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36369 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066548)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066548)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4066548)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4066548)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4066548)[0;0m 
[1;36m(EngineCore_DP0 pid=4066548)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066548)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066548)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066548)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066548)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066548)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fcc2016c3e0>' raised:
[1;36m(EngineCore_DP0 pid=4066548)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066548)[0;0m 
[1;36m(EngineCore_DP0 pid=4066548)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066548)[0;0m 
[rank0]:[W1205 16:14:47.971990791 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:15:16.636823750 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:40871 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066635)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066635)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4066635)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4066635)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4066635)[0;0m 
[1;36m(EngineCore_DP0 pid=4066635)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066635)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066635)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066635)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066635)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066635)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f0250cbe690>' raised:
[1;36m(EngineCore_DP0 pid=4066635)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066635)[0;0m 
[1;36m(EngineCore_DP0 pid=4066635)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066635)[0;0m 
[rank0]:[W1205 16:15:23.736780811 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:15:53.557053823 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:59775 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066715)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066715)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4066715)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4066715)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4066715)[0;0m 
[1;36m(EngineCore_DP0 pid=4066715)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066715)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066715)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066715)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066715)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066715)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fe4b0187860>' raised:
[1;36m(EngineCore_DP0 pid=4066715)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066715)[0;0m 
[1;36m(EngineCore_DP0 pid=4066715)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066715)[0;0m 
[rank0]:[W1205 16:16:00.651039952 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:16:28.391497012 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:39267 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066900)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066900)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4066900)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4066900)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4066900)[0;0m 
[1;36m(EngineCore_DP0 pid=4066900)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066900)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066900)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066900)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066900)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066900)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f39d423ea80>' raised:
[1;36m(EngineCore_DP0 pid=4066900)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066900)[0;0m 
[1;36m(EngineCore_DP0 pid=4066900)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066900)[0;0m 
[rank0]:[W1205 16:16:35.460140566 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:17:06.693266848 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57695 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4066987)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4066987)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4066987)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4066987)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4066987)[0;0m 
[1;36m(EngineCore_DP0 pid=4066987)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4066987)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4066987)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4066987)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4066987)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4066987)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7faeac244680>' raised:
[1;36m(EngineCore_DP0 pid=4066987)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4066987)[0;0m 
[1;36m(EngineCore_DP0 pid=4066987)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4066987)[0;0m 
[rank0]:[W1205 16:17:13.802855922 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:17:42.741103683 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:50383 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067068)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067068)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4067068)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4067068)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4067068)[0;0m 
[1;36m(EngineCore_DP0 pid=4067068)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067068)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067068)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067068)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067068)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067068)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fc7d822b710>' raised:
[1;36m(EngineCore_DP0 pid=4067068)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067068)[0;0m 
[1;36m(EngineCore_DP0 pid=4067068)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067068)[0;0m 
[rank0]:[W1205 16:17:49.878709419 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:18:19.609822777 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36731 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067152)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067152)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4067152)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4067152)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4067152)[0;0m 
[1;36m(EngineCore_DP0 pid=4067152)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067152)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067152)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067152)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067152)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067152)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb8e81d6cf0>' raised:
[1;36m(EngineCore_DP0 pid=4067152)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067152)[0;0m 
[1;36m(EngineCore_DP0 pid=4067152)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067152)[0;0m 
[rank0]:[W1205 16:18:26.703693098 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:18:55.522112745 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57587 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067241)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067241)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4067241)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4067241)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4067241)[0;0m 
[1;36m(EngineCore_DP0 pid=4067241)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067241)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067241)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067241)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067241)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067241)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff5bd273290>' raised:
[1;36m(EngineCore_DP0 pid=4067241)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067241)[0;0m 
[1;36m(EngineCore_DP0 pid=4067241)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067241)[0;0m 
[rank0]:[W1205 16:19:02.241448603 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:19:33.773568773 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:35815 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067319)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067319)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4067319)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4067319)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4067319)[0;0m 
[1;36m(EngineCore_DP0 pid=4067319)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067319)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067319)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067319)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067319)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067319)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f51141c2e70>' raised:
[1;36m(EngineCore_DP0 pid=4067319)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067319)[0;0m 
[1;36m(EngineCore_DP0 pid=4067319)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067319)[0;0m 
[rank0]:[W1205 16:19:40.246212021 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:20:10.152568379 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:36121 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067411)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067411)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4067411)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4067411)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4067411)[0;0m 
[1;36m(EngineCore_DP0 pid=4067411)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067411)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067411)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067411)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067411)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067411)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f87dee7efc0>' raised:
[1;36m(EngineCore_DP0 pid=4067411)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067411)[0;0m 
[1;36m(EngineCore_DP0 pid=4067411)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067411)[0;0m 
[rank0]:[W1205 16:20:18.884582448 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:20:48.522964394 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56387 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067492)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067492)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4067492)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4067492)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4067492)[0;0m 
[1;36m(EngineCore_DP0 pid=4067492)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067492)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067492)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067492)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067492)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067492)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f22f41205f0>' raised:
[1;36m(EngineCore_DP0 pid=4067492)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067492)[0;0m 
[1;36m(EngineCore_DP0 pid=4067492)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067492)[0;0m 
[rank0]:[W1205 16:20:55.578464329 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:21:23.993075786 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56171 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067673)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067673)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4067673)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4067673)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4067673)[0;0m 
[1;36m(EngineCore_DP0 pid=4067673)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067673)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067673)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067673)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067673)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067673)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f94343c9250>' raised:
[1;36m(EngineCore_DP0 pid=4067673)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067673)[0;0m 
[1;36m(EngineCore_DP0 pid=4067673)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067673)[0;0m 
[rank0]:[W1205 16:21:30.920878698 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:22:01.873043863 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:48835 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067764)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067764)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4067764)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4067764)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4067764)[0;0m 
[1;36m(EngineCore_DP0 pid=4067764)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067764)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067764)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067764)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067764)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067764)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fe436143140>' raised:
[1;36m(EngineCore_DP0 pid=4067764)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067764)[0;0m 
[1;36m(EngineCore_DP0 pid=4067764)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067764)[0;0m 
[rank0]:[W1205 16:22:09.811328341 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:22:39.058523047 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33555 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067844)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067844)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4067844)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4067844)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4067844)[0;0m 
[1;36m(EngineCore_DP0 pid=4067844)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067844)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067844)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067844)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067844)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067844)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f24ab4c7020>' raised:
[1;36m(EngineCore_DP0 pid=4067844)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067844)[0;0m 
[1;36m(EngineCore_DP0 pid=4067844)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067844)[0;0m 
[rank0]:[W1205 16:22:46.467412579 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:23:19.675248227 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45621 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4067929)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4067929)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4067929)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4067929)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4067929)[0;0m 
[1;36m(EngineCore_DP0 pid=4067929)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4067929)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4067929)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4067929)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4067929)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4067929)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f82042ad7f0>' raised:
[1;36m(EngineCore_DP0 pid=4067929)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4067929)[0;0m 
[1;36m(EngineCore_DP0 pid=4067929)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4067929)[0;0m 
[rank0]:[W1205 16:23:27.525445765 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:23:57.868942682 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:40429 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068018)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068018)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4068018)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4068018)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4068018)[0;0m 
[1;36m(EngineCore_DP0 pid=4068018)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068018)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068018)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068018)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068018)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068018)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4502f66fc0>' raised:
[1;36m(EngineCore_DP0 pid=4068018)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068018)[0;0m 
[1;36m(EngineCore_DP0 pid=4068018)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068018)[0;0m 
[rank0]:[W1205 16:24:04.286051510 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:24:36.535327484 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:42591 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068095)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068095)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4068095)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4068095)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4068095)[0;0m 
[1;36m(EngineCore_DP0 pid=4068095)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068095)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068095)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068095)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068095)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068095)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fbffc25e2d0>' raised:
[1;36m(EngineCore_DP0 pid=4068095)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068095)[0;0m 
[1;36m(EngineCore_DP0 pid=4068095)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068095)[0;0m 
[rank0]:[W1205 16:24:43.049105692 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:25:15.503815813 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:54145 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068186)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068186)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4068186)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4068186)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4068186)[0;0m 
[1;36m(EngineCore_DP0 pid=4068186)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068186)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068186)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068186)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068186)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068186)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f93f416fe30>' raised:
[1;36m(EngineCore_DP0 pid=4068186)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068186)[0;0m 
[1;36m(EngineCore_DP0 pid=4068186)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068186)[0;0m 
[rank0]:[W1205 16:25:22.106865804 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:25:53.260735620 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33489 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068266)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068266)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4068266)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4068266)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4068266)[0;0m 
[1;36m(EngineCore_DP0 pid=4068266)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068266)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068266)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068266)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068266)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068266)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6a3809a6f0>' raised:
[1;36m(EngineCore_DP0 pid=4068266)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068266)[0;0m 
[1;36m(EngineCore_DP0 pid=4068266)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068266)[0;0m 
[rank0]:[W1205 16:26:01.956229165 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:26:31.970801042 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41993 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068447)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068447)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4068447)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4068447)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4068447)[0;0m 
[1;36m(EngineCore_DP0 pid=4068447)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068447)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068447)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068447)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068447)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068447)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fa58c283200>' raised:
[1;36m(EngineCore_DP0 pid=4068447)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068447)[0;0m 
[1;36m(EngineCore_DP0 pid=4068447)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068447)[0;0m 
[rank0]:[W1205 16:26:38.133522842 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:27:08.460303560 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:47073 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068537)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068537)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4068537)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4068537)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4068537)[0;0m 
[1;36m(EngineCore_DP0 pid=4068537)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068537)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068537)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068537)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068537)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068537)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fae034ab170>' raised:
[1;36m(EngineCore_DP0 pid=4068537)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068537)[0;0m 
[1;36m(EngineCore_DP0 pid=4068537)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068537)[0;0m 
[rank0]:[W1205 16:27:16.967481066 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:27:45.037877528 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43259 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068618)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068618)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4068618)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4068618)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4068618)[0;0m 
[1;36m(EngineCore_DP0 pid=4068618)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068618)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068618)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068618)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068618)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068618)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f5e182a09b0>' raised:
[1;36m(EngineCore_DP0 pid=4068618)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068618)[0;0m 
[1;36m(EngineCore_DP0 pid=4068618)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068618)[0;0m 
[rank0]:[W1205 16:27:52.225855920 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:28:23.396561683 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43503 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068704)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068704)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.01it/s]
[1;36m(EngineCore_DP0 pid=4068704)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4068704)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.46it/s]
[1;36m(EngineCore_DP0 pid=4068704)[0;0m 
[1;36m(EngineCore_DP0 pid=4068704)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068704)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068704)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068704)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068704)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068704)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f5148108f50>' raised:
[1;36m(EngineCore_DP0 pid=4068704)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068704)[0;0m 
[1;36m(EngineCore_DP0 pid=4068704)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068704)[0;0m 
[rank0]:[W1205 16:28:31.260872046 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:29:00.389608135 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37563 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068792)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068792)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4068792)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4068792)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4068792)[0;0m 
[1;36m(EngineCore_DP0 pid=4068792)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068792)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068792)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068792)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068792)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068792)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fad0c177770>' raised:
[1;36m(EngineCore_DP0 pid=4068792)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068792)[0;0m 
[1;36m(EngineCore_DP0 pid=4068792)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068792)[0;0m 
[rank0]:[W1205 16:29:08.541498108 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:29:39.974569950 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43311 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068871)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068871)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4068871)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4068871)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4068871)[0;0m 
[1;36m(EngineCore_DP0 pid=4068871)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068871)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068871)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068871)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068871)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068871)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f5d281efd10>' raised:
[1;36m(EngineCore_DP0 pid=4068871)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068871)[0;0m 
[1;36m(EngineCore_DP0 pid=4068871)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068871)[0;0m 
[rank0]:[W1205 16:29:46.276828089 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:30:17.348379188 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:53709 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4068958)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4068958)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4068958)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4068958)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4068958)[0;0m 
[1;36m(EngineCore_DP0 pid=4068958)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4068958)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4068958)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4068958)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4068958)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4068958)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9948086120>' raised:
[1;36m(EngineCore_DP0 pid=4068958)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4068958)[0;0m 
[1;36m(EngineCore_DP0 pid=4068958)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4068958)[0;0m 
[rank0]:[W1205 16:30:25.547376154 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:30:55.119550701 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:48949 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069038)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069038)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4069038)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4069038)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4069038)[0;0m 
[1;36m(EngineCore_DP0 pid=4069038)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069038)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069038)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069038)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069038)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069038)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4088166180>' raised:
[1;36m(EngineCore_DP0 pid=4069038)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069038)[0;0m 
[1;36m(EngineCore_DP0 pid=4069038)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069038)[0;0m 
[rank0]:[W1205 16:31:03.811386254 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:31:34.775167837 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45709 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069218)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069218)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4069218)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4069218)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4069218)[0;0m 
[1;36m(EngineCore_DP0 pid=4069218)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069218)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069218)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069218)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069218)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069218)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fc05027c560>' raised:
[1;36m(EngineCore_DP0 pid=4069218)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069218)[0;0m 
[1;36m(EngineCore_DP0 pid=4069218)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069218)[0;0m 
[rank0]:[W1205 16:31:41.369832774 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:32:13.852018202 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41469 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069306)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069306)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4069306)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4069306)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4069306)[0;0m 
[1;36m(EngineCore_DP0 pid=4069306)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069306)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069306)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069306)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069306)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069306)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fbd3486a840>' raised:
[1;36m(EngineCore_DP0 pid=4069306)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069306)[0;0m 
[1;36m(EngineCore_DP0 pid=4069306)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069306)[0;0m 
[rank0]:[W1205 16:32:20.404744821 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:32:50.415124800 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:46293 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069387)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069387)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4069387)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4069387)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4069387)[0;0m 
[1;36m(EngineCore_DP0 pid=4069387)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069387)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069387)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069387)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069387)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069387)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb4cc1f07a0>' raised:
[1;36m(EngineCore_DP0 pid=4069387)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069387)[0;0m 
[1;36m(EngineCore_DP0 pid=4069387)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069387)[0;0m 
[rank0]:[W1205 16:32:58.870136220 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:33:29.666654324 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56257 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069474)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069474)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4069474)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4069474)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.42it/s]
[1;36m(EngineCore_DP0 pid=4069474)[0;0m 
[1;36m(EngineCore_DP0 pid=4069474)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069474)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069474)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069474)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069474)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069474)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff9243c3560>' raised:
[1;36m(EngineCore_DP0 pid=4069474)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069474)[0;0m 
[1;36m(EngineCore_DP0 pid=4069474)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069474)[0;0m 
[rank0]:[W1205 16:33:36.163235768 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:34:05.446286132 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43057 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069562)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069562)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4069562)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4069562)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4069562)[0;0m 
[1;36m(EngineCore_DP0 pid=4069562)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069562)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069562)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069562)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069562)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069562)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7ff5e425c620>' raised:
[1;36m(EngineCore_DP0 pid=4069562)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069562)[0;0m 
[1;36m(EngineCore_DP0 pid=4069562)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069562)[0;0m 
[rank0]:[W1205 16:34:13.593632989 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:34:43.077480117 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:47983 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069644)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069644)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4069644)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4069644)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.46it/s]
[1;36m(EngineCore_DP0 pid=4069644)[0;0m 
[1;36m(EngineCore_DP0 pid=4069644)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069644)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069644)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069644)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069644)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069644)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f23f2d8f470>' raised:
[1;36m(EngineCore_DP0 pid=4069644)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069644)[0;0m 
[1;36m(EngineCore_DP0 pid=4069644)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069644)[0;0m 
[rank0]:[W1205 16:34:51.618258488 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:35:21.541437335 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:42065 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069733)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069733)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4069733)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4069733)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4069733)[0;0m 
[1;36m(EngineCore_DP0 pid=4069733)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069733)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069733)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069733)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069733)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069733)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f317c379730>' raised:
[1;36m(EngineCore_DP0 pid=4069733)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069733)[0;0m 
[1;36m(EngineCore_DP0 pid=4069733)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069733)[0;0m 
[rank0]:[W1205 16:35:28.822109551 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:35:59.816489175 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:57935 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069820)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069820)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4069820)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4069820)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4069820)[0;0m 
[1;36m(EngineCore_DP0 pid=4069820)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069820)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069820)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069820)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069820)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069820)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f8a282a4560>' raised:
[1;36m(EngineCore_DP0 pid=4069820)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069820)[0;0m 
[1;36m(EngineCore_DP0 pid=4069820)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069820)[0;0m 
[rank0]:[W1205 16:36:06.990491429 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:36:36.758833535 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:52811 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4069996)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4069996)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4069996)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4069996)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4069996)[0;0m 
[1;36m(EngineCore_DP0 pid=4069996)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4069996)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4069996)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4069996)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4069996)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4069996)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f19902c39b0>' raised:
[1;36m(EngineCore_DP0 pid=4069996)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4069996)[0;0m 
[1;36m(EngineCore_DP0 pid=4069996)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4069996)[0;0m 
[rank0]:[W1205 16:36:43.336422465 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:37:15.546442705 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:59691 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070084)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070084)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4070084)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4070084)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4070084)[0;0m 
[1;36m(EngineCore_DP0 pid=4070084)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070084)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070084)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070084)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070084)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070084)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f146c1673b0>' raised:
[1;36m(EngineCore_DP0 pid=4070084)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070084)[0;0m 
[1;36m(EngineCore_DP0 pid=4070084)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070084)[0;0m 
[rank0]:[W1205 16:37:22.786129731 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:37:51.313668599 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:56695 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070165)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070165)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  2.00it/s]
[1;36m(EngineCore_DP0 pid=4070165)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.56it/s]
[1;36m(EngineCore_DP0 pid=4070165)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.46it/s]
[1;36m(EngineCore_DP0 pid=4070165)[0;0m 
[1;36m(EngineCore_DP0 pid=4070165)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070165)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070165)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070165)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070165)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070165)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f2802e2f2f0>' raised:
[1;36m(EngineCore_DP0 pid=4070165)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070165)[0;0m 
[1;36m(EngineCore_DP0 pid=4070165)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070165)[0;0m 
[rank0]:[W1205 16:37:58.441780374 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:38:30.814575684 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:51101 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070250)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070250)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4070250)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4070250)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4070250)[0;0m 
[1;36m(EngineCore_DP0 pid=4070250)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070250)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070250)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070250)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070250)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070250)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f01456ceea0>' raised:
[1;36m(EngineCore_DP0 pid=4070250)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070250)[0;0m 
[1;36m(EngineCore_DP0 pid=4070250)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070250)[0;0m 
[rank0]:[W1205 16:38:37.990876992 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:39:06.440729823 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:39727 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070339)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070339)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4070339)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4070339)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4070339)[0;0m 
[1;36m(EngineCore_DP0 pid=4070339)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070339)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070339)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070339)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070339)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070339)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7efe101984a0>' raised:
[1;36m(EngineCore_DP0 pid=4070339)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070339)[0;0m 
[1;36m(EngineCore_DP0 pid=4070339)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070339)[0;0m 
[rank0]:[W1205 16:39:14.803714491 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:39:45.840303883 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:40155 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070420)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070420)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4070420)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4070420)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4070420)[0;0m 
[1;36m(EngineCore_DP0 pid=4070420)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070420)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070420)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070420)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070420)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070420)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9fdc13fbc0>' raised:
[1;36m(EngineCore_DP0 pid=4070420)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070420)[0;0m 
[1;36m(EngineCore_DP0 pid=4070420)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070420)[0;0m 
[rank0]:[W1205 16:39:52.181365350 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:40:22.780425988 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:33805 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070507)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070507)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4070507)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.52it/s]
[1;36m(EngineCore_DP0 pid=4070507)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.42it/s]
[1;36m(EngineCore_DP0 pid=4070507)[0;0m 
[1;36m(EngineCore_DP0 pid=4070507)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070507)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070507)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070507)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070507)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070507)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f4d8c2094c0>' raised:
[1;36m(EngineCore_DP0 pid=4070507)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070507)[0;0m 
[1;36m(EngineCore_DP0 pid=4070507)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070507)[0;0m 
[rank0]:[W1205 16:40:29.130116552 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:41:00.654489401 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43033 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070593)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070593)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.92it/s]
[1;36m(EngineCore_DP0 pid=4070593)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.50it/s]
[1;36m(EngineCore_DP0 pid=4070593)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.39it/s]
[1;36m(EngineCore_DP0 pid=4070593)[0;0m 
[1;36m(EngineCore_DP0 pid=4070593)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070593)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070593)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070593)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070593)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070593)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f2b702b93d0>' raised:
[1;36m(EngineCore_DP0 pid=4070593)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070593)[0;0m 
[1;36m(EngineCore_DP0 pid=4070593)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070593)[0;0m 
[rank0]:[W1205 16:41:09.491586340 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:41:40.717093390 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:32867 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070772)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070772)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.91it/s]
[1;36m(EngineCore_DP0 pid=4070772)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.49it/s]
[1;36m(EngineCore_DP0 pid=4070772)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.38it/s]
[1;36m(EngineCore_DP0 pid=4070772)[0;0m 
[1;36m(EngineCore_DP0 pid=4070772)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070772)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070772)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070772)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070772)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070772)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fab34532c90>' raised:
[1;36m(EngineCore_DP0 pid=4070772)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070772)[0;0m 
[1;36m(EngineCore_DP0 pid=4070772)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070772)[0;0m 
[rank0]:[W1205 16:41:49.579894342 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:42:21.425237011 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:39115 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070857)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070857)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.93it/s]
[1;36m(EngineCore_DP0 pid=4070857)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.50it/s]
[1;36m(EngineCore_DP0 pid=4070857)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.40it/s]
[1;36m(EngineCore_DP0 pid=4070857)[0;0m 
[1;36m(EngineCore_DP0 pid=4070857)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070857)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070857)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070857)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070857)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070857)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fb60d5971d0>' raised:
[1;36m(EngineCore_DP0 pid=4070857)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070857)[0;0m 
[1;36m(EngineCore_DP0 pid=4070857)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070857)[0;0m 
[rank0]:[W1205 16:42:30.576783954 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:43:01.338729670 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:49209 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4070948)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4070948)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.98it/s]
[1;36m(EngineCore_DP0 pid=4070948)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.54it/s]
[1;36m(EngineCore_DP0 pid=4070948)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4070948)[0;0m 
[1;36m(EngineCore_DP0 pid=4070948)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4070948)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4070948)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4070948)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4070948)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4070948)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f39780a68d0>' raised:
[1;36m(EngineCore_DP0 pid=4070948)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4070948)[0;0m 
[1;36m(EngineCore_DP0 pid=4070948)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4070948)[0;0m 
[rank0]:[W1205 16:43:09.966013338 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:43:39.164403052 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:37633 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4071027)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4071027)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.93it/s]
[1;36m(EngineCore_DP0 pid=4071027)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.50it/s]
[1;36m(EngineCore_DP0 pid=4071027)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.40it/s]
[1;36m(EngineCore_DP0 pid=4071027)[0;0m 
[1;36m(EngineCore_DP0 pid=4071027)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4071027)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4071027)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071027)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4071027)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4071027)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f3304334620>' raised:
[1;36m(EngineCore_DP0 pid=4071027)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4071027)[0;0m 
[1;36m(EngineCore_DP0 pid=4071027)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4071027)[0;0m 
[rank0]:[W1205 16:43:46.391671655 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:44:16.905233054 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:41003 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4071114)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4071114)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4071114)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4071114)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4071114)[0;0m 
[1;36m(EngineCore_DP0 pid=4071114)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4071114)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4071114)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071114)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4071114)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4071114)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fc17d9aeb10>' raised:
[1;36m(EngineCore_DP0 pid=4071114)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4071114)[0;0m 
[1;36m(EngineCore_DP0 pid=4071114)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4071114)[0;0m 
[rank0]:[W1205 16:44:23.236874362 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:44:54.119543197 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:47055 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4071199)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4071199)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4071199)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4071199)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4071199)[0;0m 
[1;36m(EngineCore_DP0 pid=4071199)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4071199)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4071199)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071199)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4071199)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4071199)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f6a923bc920>' raised:
[1;36m(EngineCore_DP0 pid=4071199)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4071199)[0;0m 
[1;36m(EngineCore_DP0 pid=4071199)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4071199)[0;0m 
[rank0]:[W1205 16:45:02.111341019 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:45:31.422052840 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:50969 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4071285)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4071285)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4071285)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4071285)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.45it/s]
[1;36m(EngineCore_DP0 pid=4071285)[0;0m 
[1;36m(EngineCore_DP0 pid=4071285)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4071285)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4071285)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071285)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4071285)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4071285)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f22e9f9fd10>' raised:
[1;36m(EngineCore_DP0 pid=4071285)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4071285)[0;0m 
[1;36m(EngineCore_DP0 pid=4071285)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4071285)[0;0m 
[rank0]:[W1205 16:45:39.523436870 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:46:10.566869371 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45367 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4071372)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4071372)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.97it/s]
[1;36m(EngineCore_DP0 pid=4071372)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.53it/s]
[1;36m(EngineCore_DP0 pid=4071372)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.43it/s]
[1;36m(EngineCore_DP0 pid=4071372)[0;0m 
[1;36m(EngineCore_DP0 pid=4071372)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4071372)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4071372)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071372)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4071372)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4071372)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7fc461c36e10>' raised:
[1;36m(EngineCore_DP0 pid=4071372)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4071372)[0;0m 
[1;36m(EngineCore_DP0 pid=4071372)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4071372)[0;0m 
[rank0]:[W1205 16:46:17.852987503 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:46:46.057712109 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:45779 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4071549)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4071549)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.99it/s]
[1;36m(EngineCore_DP0 pid=4071549)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.55it/s]
[1;36m(EngineCore_DP0 pid=4071549)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.44it/s]
[1;36m(EngineCore_DP0 pid=4071549)[0;0m 
[1;36m(EngineCore_DP0 pid=4071549)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4071549)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4071549)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071549)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4071549)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4071549)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f66e4b9c830>' raised:
[1;36m(EngineCore_DP0 pid=4071549)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4071549)[0;0m 
[1;36m(EngineCore_DP0 pid=4071549)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4071549)[0;0m 
[rank0]:[W1205 16:46:53.214994293 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[W1205 16:47:24.561405221 socket.cpp:767] [c10d] The client socket cannot be initialized to connect to [gpu-30-0.rc.tch.harvard.edu]:43671 (errno: 97 - Address family not supported by protocol).
[1;36m(EngineCore_DP0 pid=4071637)[0;0m Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[1;36m(EngineCore_DP0 pid=4071637)[0;0m Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.95it/s]
[1;36m(EngineCore_DP0 pid=4071637)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.52it/s]
[1;36m(EngineCore_DP0 pid=4071637)[0;0m Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:00<00:00,  2.42it/s]
[1;36m(EngineCore_DP0 pid=4071637)[0;0m 
[1;36m(EngineCore_DP0 pid=4071637)[0;0m Process EngineCore_DP0:
[1;36m(EngineCore_DP0 pid=4071637)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     self.run()
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 846, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     raise e
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     super().__init__(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 109, in __init__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     num_gpu_blocks, num_cpu_blocks, kv_cache_config = self._initialize_kv_caches(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 231, in _initialize_kv_caches
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     available_gpu_memory = self.model_executor.determine_available_memory()
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 126, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return self.collective_rpc("determine_available_memory")
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 75, in collective_rpc
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     result = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/serial_utils.py", line 479, in run_method
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 324, in determine_available_memory
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     self.model_runner.profile_run()
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 4135, in profile_run
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     hidden_states, last_hidden_states = self._dummy_run(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                                         ^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 3855, in _dummy_run
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     outputs = self.model(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m               ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/cuda_graph.py", line 126, in __call__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return self.runnable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return self._call_impl(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return forward_call(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/model_executor/models/llama.py", line 655, in forward
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     model_output = self.model(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                    ^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/decorators.py", line 471, in __call__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     output = TorchCompileWithNoGuardsWrapper.__call__(self, *args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/wrapper.py", line 149, in __call__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return self._compiled_callable(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 845, in compile_wrapper
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     raise e.remove_dynamo_frames() from None  # see TORCHDYNAMO_VERBOSE=1
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2196, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     raise BackendCompilerFailed(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/output_graph.py", line 2171, in _call_user_compiler
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     compiled_fn = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_dynamo/repro/after_dynamo.py", line 156, in __call__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     compiled_gm = compiler_fn(gm, example_inputs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/__init__.py", line 2437, in __call__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return self.compiler_fn(model_, inputs_, **self.kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 683, in __call__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     PiecewiseCompileInterpreter(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 404, in run
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return super().run(*fake_args)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 174, in run
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     self.env[node] = self.run_node(node)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/fx/interpreter.py", line 256, in run_node
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     return getattr(self, n.op)(n.target, args, kwargs)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 424, in call_module
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     self.vllm_backend.compiler_manager.compile(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 201, in compile
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     compiled_graph = self.load(graph, example_inputs, graph_index, runtime_shape)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/backends.py", line 161, in load
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     compiled_graph = self.compiler.load(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                      ^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/vllm/compilation/compiler_interface.py", line 260, in load
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     inductor_compiled_graph = torch._inductor.CompiledArtifact.load(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/_inductor/standalone_compile.py", line 131, in load
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     reader = BytesReader(artifacts)
[1;36m(EngineCore_DP0 pid=4071637)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=4071637)[0;0m   File "/home/ch269957/.conda/envs/slm/lib/python3.12/site-packages/torch/utils/_appending_byte_serializer.py", line 55, in __init__
[1;36m(EngineCore_DP0 pid=4071637)[0;0m     raise RuntimeError(
[1;36m(EngineCore_DP0 pid=4071637)[0;0m torch._dynamo.exc.BackendCompilerFailed: backend='<vllm.compilation.backends.VllmBackend object at 0x7f9ae00eb860>' raised:
[1;36m(EngineCore_DP0 pid=4071637)[0;0m RuntimeError: Bytes object is corrupted, checksum does not match. Expected: b' \xdc9\x91', Got: b'\x89\xfc\x9d\xa9'
[1;36m(EngineCore_DP0 pid=4071637)[0;0m 
[1;36m(EngineCore_DP0 pid=4071637)[0;0m Set TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS="+dynamo"
[1;36m(EngineCore_DP0 pid=4071637)[0;0m 
[rank0]:[W1205 16:47:31.857722789 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
